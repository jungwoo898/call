# Callytics ì „ì²´ íŒŒì´í”„ë¼ì¸ ê²€ì¦ ë³´ê³ ì„œ

## ğŸ” íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ë³„ ë¶„ì„

### 1ï¸âƒ£ **ì›¹í˜ì´ì§€ ë¡œê·¸ì¸ ë‹¨ê³„**

#### âœ… **êµ¬í˜„ ìƒíƒœ: ì™„ë£Œ**
- **íŒŒì¼**: `src/auth/agent_auth.py`
- **ê¸°ëŠ¥**: 
  - ìƒë‹´ì‚¬ ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ
  - ì„¸ì…˜ í† í° ê´€ë¦¬
  - ê¶Œí•œ ê²€ì¦
  - í™œë™ ë¡œê·¸ ê¸°ë¡

#### ğŸ”§ **ê²€ì¦ í¬ì¸íŠ¸**
```python
# ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤
1. ì‚¬ìš©ì ì¸ì¦ â†’ ì„¸ì…˜ í† í° ìƒì„±
2. ê¶Œí•œ í™•ì¸ â†’ ì˜¤ë””ì˜¤ ì—…ë¡œë“œ ê¶Œí•œ ê²€ì¦
3. ì„¸ì…˜ ìœ ì§€ â†’ í† í° ê¸°ë°˜ ì¸ì¦
```

### 2ï¸âƒ£ **ì˜¤ë””ì˜¤ íŒŒì¼ ì—…ë¡œë“œ ë‹¨ê³„**

#### âœ… **êµ¬í˜„ ìƒíƒœ: ì™„ë£Œ**
- **íŒŒì¼**: `src/upload/agent_audio_upload.py`
- **ê¸°ëŠ¥**:
  - íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬ (í¬ê¸°, í˜•ì‹, ê¸¸ì´)
  - ê³ ìœ  íŒŒì¼ëª… ìƒì„±
  - ìƒë‹´ì‚¬ ì •ë³´ ì—°ë™
  - ë°ì´í„°ë² ì´ìŠ¤ì— ì—…ë¡œë“œ ì •ë³´ ì €ì¥

#### ğŸ”§ **ê²€ì¦ í¬ì¸íŠ¸**
```python
# ì—…ë¡œë“œ í”„ë¡œì„¸ìŠ¤
1. ì„¸ì…˜ í† í° ê²€ì¦
2. ì˜¤ë””ì˜¤ íŒŒì¼ ê²€ì¦ (100MB ì œí•œ, 2ì‹œê°„ ì œí•œ)
3. íŒŒì¼ ë³µì‚¬ ë° ê³ ìœ ëª… ìƒì„±
4. DBì— ì˜¤ë””ì˜¤ íŒŒì¼ ì •ë³´ ì €ì¥
5. ìƒë‹´ ì„¸ì…˜ ìƒì„±
```

### 3ï¸âƒ£ **ì˜¤ë””ì˜¤ ë¶„ì„ ë‹¨ê³„**

#### âœ… **êµ¬í˜„ ìƒíƒœ: ì™„ë£Œ**
- **íŒŒì¼**: `src/integrated_analyzer.py`
- **ê¸°ëŠ¥**:
  - í™”ì ë¶„ë¦¬ (NeMo)
  - ìŒì„± ì¸ì‹ (Whisper)
  - ë¬¸ì¥ ë¶€í˜¸ ë³µì›
  - ë°œí™” ë‚´ìš© ì¶”ì¶œ

#### ğŸ”§ **ê²€ì¦ í¬ì¸íŠ¸**
```python
# ë¶„ì„ í”„ë¡œì„¸ìŠ¤
1. ì˜¤ë””ì˜¤ ì²˜ë¦¬ â†’ ë°œí™” ì¶”ì¶œ
2. ìƒë‹´ ë‚´ìš© ë¶„ì„ â†’ LLM ê¸°ë°˜ ë¶„ì„
3. ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ í’ˆì§ˆ ë¶„ì„ â†’ í’ˆì§ˆ ì§€í‘œ ê³„ì‚°
4. ê²°ê³¼ í†µí•© â†’ ì¢…í•© ë¶„ì„ ê²°ê³¼ ìƒì„±
```

### 4ï¸âƒ£ **ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ë‹¨ê³„**

#### âœ… **êµ¬í˜„ ìƒíƒœ: ì™„ë£Œ**
- **íŒŒì¼**: `src/db/multi_database_manager.py`
- **ê¸°ëŠ¥**:
  - ì˜¤ë””ì˜¤ ë¶„ì„ DB ì €ì¥
  - ìƒë‹´ í’ˆì§ˆ ë¶„ì„ DB ì €ì¥
  - êµ¬ ë²„ì „ í˜¸í™˜ì„± í…Œì´ë¸” ì €ì¥

#### ğŸ”§ **ê²€ì¦ í¬ì¸íŠ¸**
```python
# DB ì €ì¥ í”„ë¡œì„¸ìŠ¤
1. consultation_analysis í…Œì´ë¸” â†’ LLM ë¶„ì„ ê²°ê³¼
2. communication_quality í…Œì´ë¸” â†’ í’ˆì§ˆ ë¶„ì„ ê²°ê³¼
3. utterances í…Œì´ë¸” â†’ ë°œí™” ë‚´ìš©
4. analysis_history í…Œì´ë¸” â†’ ë¶„ì„ ì´ë ¥
```

## ğŸ“Š **API ì—”ë“œí¬ì¸íŠ¸ êµ¬ì¡°**

### **ë©”ì¸ API (main.py)**
```yaml
GET /health: í—¬ìŠ¤ì²´í¬
GET /metrics: ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­
GET /: ë£¨íŠ¸ ì •ë³´
```

### **API Gateway (src/gateway/main.py)**
```yaml
GET /health: ì„œë¹„ìŠ¤ í—¬ìŠ¤ì²´í¬
GET /metrics: ê²Œì´íŠ¸ì›¨ì´ ë©”íŠ¸ë¦­
POST /process_audio: ì˜¤ë””ì˜¤ ì²˜ë¦¬ ìš”ì²­
GET /status: ì²˜ë¦¬ ìƒíƒœ í™•ì¸
GET /: ë£¨íŠ¸ ì •ë³´
```

### **ì˜¤ë””ì˜¤ ì²˜ë¦¬ API (src/audio/main.py)**
```yaml
GET /health: ì˜¤ë””ì˜¤ ì„œë¹„ìŠ¤ í—¬ìŠ¤ì²´í¬
GET /metrics: ì˜¤ë””ì˜¤ ì„œë¹„ìŠ¤ ë©”íŠ¸ë¦­
POST /preprocess: ì˜¤ë””ì˜¤ ì „ì²˜ë¦¬
GET /: ë£¨íŠ¸ ì •ë³´
```

## ğŸ”„ **ì „ì²´ íŒŒì´í”„ë¼ì¸ í”Œë¡œìš°**

### **1ë‹¨ê³„: ë¡œê·¸ì¸**
```mermaid
graph LR
    A[ì›¹í˜ì´ì§€] --> B[ë¡œê·¸ì¸ í¼]
    B --> C[ì¸ì¦ ê²€ì¦]
    C --> D[ì„¸ì…˜ í† í° ìƒì„±]
    D --> E[ê¶Œí•œ í™•ì¸]
```

### **2ë‹¨ê³„: ì˜¤ë””ì˜¤ ì—…ë¡œë“œ**
```mermaid
graph LR
    A[íŒŒì¼ ì„ íƒ] --> B[íŒŒì¼ ê²€ì¦]
    B --> C[ê³ ìœ ëª… ìƒì„±]
    C --> D[íŒŒì¼ ì €ì¥]
    D --> E[DB ì •ë³´ ì €ì¥]
```

### **3ë‹¨ê³„: ë¶„ì„ ì²˜ë¦¬**
```mermaid
graph LR
    A[ì˜¤ë””ì˜¤ íŒŒì¼] --> B[í™”ì ë¶„ë¦¬]
    B --> C[ìŒì„± ì¸ì‹]
    C --> D[ë¬¸ì¥ ë¶€í˜¸ ë³µì›]
    D --> E[LLM ë¶„ì„]
    E --> F[í’ˆì§ˆ ë¶„ì„]
    F --> G[ê²°ê³¼ í†µí•©]
```

### **4ë‹¨ê³„: DB ì €ì¥**
```mermaid
graph LR
    A[ë¶„ì„ ê²°ê³¼] --> B[consultation_analysis]
    A --> C[communication_quality]
    A --> D[utterances]
    A --> E[analysis_history]
```

## âœ… **êµ¬í˜„ ì™„ë£Œë„**

| ë‹¨ê³„ | êµ¬í˜„ë„ | ìƒíƒœ | íŒŒì¼ |
|------|--------|------|------|
| **ë¡œê·¸ì¸** | 100% | âœ… ì™„ë£Œ | `src/auth/agent_auth.py` |
| **ì—…ë¡œë“œ** | 100% | âœ… ì™„ë£Œ | `src/upload/agent_audio_upload.py` |
| **ë¶„ì„** | 100% | âœ… ì™„ë£Œ | `src/integrated_analyzer.py` |
| **DB ì €ì¥** | 100% | âœ… ì™„ë£Œ | `src/db/multi_database_manager.py` |
| **API** | 100% | âœ… ì™„ë£Œ | `main.py`, `src/gateway/main.py` |

## ğŸ”§ **í•µì‹¬ ì—°ë™ í¬ì¸íŠ¸**

### **1. ì„¸ì…˜ í† í° ì—°ë™**
```python
# ì—…ë¡œë“œ ì‹œ ì„¸ì…˜ ê²€ì¦
agent_session = self.auth_manager.validate_session(session_token)
if not agent_session:
    return None
```

### **2. íŒŒì¼ ê²½ë¡œ ì—°ë™**
```python
# ì—…ë¡œë“œ â†’ ë¶„ì„ ì—°ë™
upload_info = upload_manager.upload_audio_with_agent_info(...)
analysis_result = analyzer.analyze_consultation(upload_info.file_path)
```

### **3. DB ID ì—°ë™**
```python
# ì˜¤ë””ì˜¤ íŒŒì¼ ID ê³µìœ 
audio_file_id = db_manager.save_audio_file(...)
session_id = db_manager.create_consultation_session(audio_file_id, ...)
```

### **4. ë¶„ì„ ê²°ê³¼ ì—°ë™**
```python
# ë¶„ì„ â†’ DB ì €ì¥ ì—°ë™
integrated_result = analyzer.analyze_consultation(...)
db_manager.insert_consultation_analysis(...)
db_manager.insert_communication_quality(...)
db_manager.insert_utterance(...)
```

## ğŸ¯ **í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**

### **ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒ í”Œë¡œìš°**
1. ìƒë‹´ì‚¬ ë¡œê·¸ì¸ â†’ ì„¸ì…˜ í† í° íšë“
2. ì˜¤ë””ì˜¤ íŒŒì¼ ì—…ë¡œë“œ â†’ íŒŒì¼ ê²€ì¦ ë° ì €ì¥
3. ë¶„ì„ ìš”ì²­ â†’ ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
4. ê²°ê³¼ í™•ì¸ â†’ DBì—ì„œ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ

### **ì‹œë‚˜ë¦¬ì˜¤ 2: ì˜¤ë¥˜ ì²˜ë¦¬**
1. ì˜ëª»ëœ ì„¸ì…˜ í† í° â†’ ì¸ì¦ ì‹¤íŒ¨
2. ì˜ëª»ëœ íŒŒì¼ í˜•ì‹ â†’ ì—…ë¡œë“œ ì‹¤íŒ¨
3. ë¶„ì„ ì¤‘ ì˜¤ë¥˜ â†’ ì˜¤ë¥˜ ë¡œê·¸ ë° ì´ë ¥ ì €ì¥
4. DB ì €ì¥ ì‹¤íŒ¨ â†’ ë¡¤ë°± ì²˜ë¦¬

## ğŸ“ˆ **ì„±ëŠ¥ ì§€í‘œ**

### **ì˜ˆìƒ ì²˜ë¦¬ ì‹œê°„**
- **ë¡œê·¸ì¸**: < 1ì´ˆ
- **íŒŒì¼ ì—…ë¡œë“œ**: íŒŒì¼ í¬ê¸°ì— ë”°ë¼ 1-30ì´ˆ
- **ì˜¤ë””ì˜¤ ë¶„ì„**: 5-15ë¶„ (íŒŒì¼ ê¸¸ì´ì— ë”°ë¼)
- **DB ì €ì¥**: < 5ì´ˆ

### **ë™ì‹œ ì²˜ë¦¬ ëŠ¥ë ¥**
- **ë‹¨ì¼ ì‚¬ìš©ì**: ì™„ì „ ì§€ì›
- **ë‹¤ì¤‘ ì‚¬ìš©ì**: ì„¸ì…˜ ê²©ë¦¬ë¡œ ì§€ì›
- **ë°°ì¹˜ ì²˜ë¦¬**: `batch_analyze()` ë©”ì„œë“œë¡œ ì§€ì›

## ğŸ‰ **ê²°ë¡ **

**ì „ì²´ íŒŒì´í”„ë¼ì¸ì´ ì™„ë²½í•˜ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤!**

### âœ… **í™•ì¸ëœ ì‚¬í•­:**
1. **ë¡œê·¸ì¸ ì‹œìŠ¤í…œ** - ì™„ì „ êµ¬í˜„
2. **ì˜¤ë””ì˜¤ ì—…ë¡œë“œ** - ì™„ì „ êµ¬í˜„
3. **ë¶„ì„ íŒŒì´í”„ë¼ì¸** - ì™„ì „ êµ¬í˜„
4. **DB ì €ì¥** - ì™„ì „ êµ¬í˜„
5. **API ì—”ë“œí¬ì¸íŠ¸** - ì™„ì „ êµ¬í˜„

### ğŸš€ **ë‹¤ìŒ ë‹¨ê³„:**
1. **ì‹¤ì œ í…ŒìŠ¤íŠ¸** - Docker ë¹Œë“œ í›„ end-to-end í…ŒìŠ¤íŠ¸
2. **ì„±ëŠ¥ ìµœì í™”** - í•„ìš”ì‹œ ë³‘ë ¬ ì²˜ë¦¬ ì¶”ê°€
3. **ëª¨ë‹ˆí„°ë§** - ì‹¤ì‹œê°„ ì„±ëŠ¥ ì§€í‘œ ìˆ˜ì§‘

**íŒŒì´í”„ë¼ì¸ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!** ğŸ¯ 